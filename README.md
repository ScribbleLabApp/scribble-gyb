# Scribble GYB (Generate Your Boilerplate)

The Scribble GYB configuration simplifies boilerplate code generation for ScribbleLabApp projects. By utilizing Python scripting capabilities, GYB provides a flexible approach to reducing repetitive code and improving consistency in Swift, Objective-C, and Objective-C++ projects.

## Table of Contents

1. [Overview](#overview)
2. [Installation](#installation)
   
   2.1 [Add scribble-gyb as git submodule](#option-1-add-scribble-gyb-as-git-submodule)
   
   2.2 [Manually Copy Files](#option-2-manually-copy-files-recommended)

3. [Template Syntax](#template-syntax)
   
   3.1 [Code Blocks](#python-code-blocks)
   
   3.2 [Variables & Placeholders](#variables-and-placeholders)
   
   3.3 [Conditional Logic](#conditional-logic)

   3.4 [Loops](#loops)

4. [Supported Types](#supported-types)
   
   4.1 [Supported Swift Types](#supported-swift-types)

   4.2 [Supported ObjC Types](#supported-objective-c-types)

   4.3 [Supported ObjC++ Types](#supported-objective-c-types-1)

5. [Using gyb_utils.py for Shared Utilities](#using-gyb-utils-py-for-shared-utilities)

   5.1 [Declaring global variables](#declaring-global-utilities-in-gyb-utils-py)

   5.2 [Importing and Using Utilities](#importing-and-using-utilities-in-gyb-templates)

6. [Using GYB with ObjC and ObjC++](#using-gyb-with-objective-c-and-objective-c++)

7. [Running Scribble-GYB](#running-scribble-gyb)

   7.1 [Steps to generate Source files](#steps-to-generate-code)

8. [Best Practices](#best-practices)

9. [Copyright Notice](#copyright-notice)

10. [Support Us](#support-us)

## Overview

GYB (Generate Your Boilerplate) is a tool used to generate source code by mixing Python code with template files. It allows developers to avoid redundancy by dynamically generating patterns across different files or languages. Scribble GYB offers a powerful way to ensure clean, consistent code while minimizing manual coding effort.

## Installation

Scribble GYB can be integrated into your project either as a Git submodule or by manually copying files into the project directory.

### Option 1: Add scribble-gyb as git submodule

1. Navigate to your project you want to use scribble-gyb in:

   ```shell
   cd your-project
   ```

2. Clone the repository into your project as a submodule:

    ```shell
    git clone https://github.com/ScribbleLabApp/scribble-gyb.git
    ```
3. Initialize and update the submodule:
    
    ```shell
    git submodule init
    git submodule update
    ```

#### Option 2: Manually Copy Files `(recommended)`

1. Clone the scribble-gyb config repository:

    ```shell
    git clone https://github.com/ScribbleLabApp/scribble-gyb.git
    ```

2. Create a `utils` directory in your project:   
   ```shell
   mkdir -p /path/to/your-project/utils
   ```

3. Copy the gyb runtime preprocessor to your repo

   ```shell
   cp -R scribble-gyb/* /path/to/your-project/utils/
   ```

4. Navigate to your project directory and ensure the files are in place under the utils directory.

## Template Syntax

GYB templates are composed of two primary elements:

   - **Python code blocks** for logic and control flow.
   - **Code placeholders** that insert Python values into generated code.

#### Python Code Blocks

Python code is either written inside `%{ ... }%` or `${...}$` blocks. These blocks are executed at template processing time, allowing for dynamic code generation based on runtime values or logic.

```python
%{
    import random
    random_value = random.randint(1, 100)
}%
```

#### Variables and Placeholders

Python variables defined inside a GYB template can be inserted into Swift, Objective-C, or Objective-C++ code using `${var}` syntax.

```swift
%{
py_greeting = "Hello, GYB!"
}%

public struct Greeting {
    public let message: String = "${py_greeting}"
}

print(Greeting.message) // [OUTPUT] ~> Hello, GYB!
```

```objc
%{
   message = "Hello, GYB ObjC!"
}%

NSString *greeting = @"${message}"; // [OUTPUT] ~> Hello, GYB ObjC!
```

#### Conditional Logic

GYB supports Python control flow constructs such as if statements, enabling conditional code generation.

```swift
%{
   is_logged_in = True
}%

% if is_logged_in:
   print("Welcome back!")
% else:
   print("Please log in.")
% end
```

```objc
%{
   use_large_buffer = True
}%

% if use_large_buffer:
   #define BUFFER_SIZE 1024
% else:
   #define BUFFER_SIZE 256
% end

char buffer[BUFFER_SIZE];
```

### Loops

GYB templates can use Python's `for` loops to generate repeated code blocks. 

```swift
%{
   fields = ['name', 'age', 'email']
}%

struct User {
   % for field in fields:
      var ${field}: String
   % end
}
```

##### Autogenerated Source

```swift
struct User {
   var name: String
   var age: String
   var email: String
}
```

```objc
%{
   methods = ['getName', 'getAge', 'getEmail']
}%

@interface User : NSObject
% for method in methods:
- (NSString *)${method};
% end
@end
```

##### Autogenerated Source

```objc
@interface User : NSObject

- (NSString *)getName;
- (NSString *)getAge;
- (NSString *)getEmail;

@end
```

## Supported Types

GYB supports a variety of data types, allowing you to easily generate code with the required type annotations and variable declarations. The following types are supported:

### Supported Swift Types

| **Type**       | **Description**                                   | **Value**                                   | **Example**                |
|----------------|---------------------------------------------------|---------------------------------------------|----------------------------|
| `String`       | Represents a sequence of characters.              | N/A                                         | `"Hello, World!"`           |
| `Int`          | Represents a signed integer.                      | `-9223372036854775808` to `9223372036854775807` | `42`                       |
| `Int8`         | Represents an 8-bit signed integer.               | `-128` to `127`                             | `Int8(127)`                |
| `Int16`        | Represents a 16-bit signed integer.               | `-32768` to `32767`                         | `Int16(32767)`             |
| `Int32`        | Represents a 32-bit signed integer.               | `-2147483648` to `2147483647`               | `Int32(2147483647)`        |
| `Int64`        | Represents a 64-bit signed integer.               | `-9223372036854775808` to `9223372036854775807` | `Int64(9223372036854775807)` |
| `UInt8`        | Represents an 8-bit unsigned integer.             | `0` to `255`                                | `UInt8(255)`               |
| `UInt16`       | Represents a 16-bit unsigned integer.             | `0` to `65535`                              | `UInt16(65535)`            |
| `UInt32`       | Represents a 32-bit unsigned integer.             | `0` to `4294967295`                         | `UInt32(4294967295)`       |
| `UInt64`       | Represents a 64-bit unsigned integer.             | `0` to `18446744073709551615`               | `UInt64(18446744073709551615)` |
| `Bool`         | Represents a Boolean value (`true` or `false`).   | `true` or `false`                           | `true`                     |
| `Double`       | Represents a double-precision floating-point number. | ~¬±1.7e308                                  | `3.14159`                  |
| `Float`        | Represents a single-precision floating-point number. | ~¬±3.4e38                                   | `2.71828f`                 |

### Supported Objective-C Types

| **Type**       | **Description**                                   | **Value**                                   | **Example**                |
|----------------|---------------------------------------------------|---------------------------------------------|----------------------------|
| `NSString`     | Represents a string object.                       | N/A                                         | `@"Hello, World!"`          |
| `NSInteger`    | Represents a signed integer.                      | `-9223372036854775808` to `9223372036854775807` | `NSInteger value = 42;`    |
| `NSUInteger`   | Represents an unsigned integer.                   | `0` to `18446744073709551615`               | `NSUInteger count = 10;`   |
| `BOOL`         | Represents a Boolean value (`YES` or `NO`).        | `YES` or `NO`                               | `BOOL isActive = YES;`     |
| `CGFloat`      | Represents a floating-point number, typically used for UI measurements. | Varies depending on the platform            | `CGFloat width = 100.0;`   |

### Supported Objective-C++ Types

| **Type**       | **Description**                                   | **Value**                                   | **Example**                |
|----------------|---------------------------------------------------|---------------------------------------------|----------------------------|
| `std::string`  | Represents a string object from the C++ Standard Library. | N/A                                     | `std::string name = "John";`|
| `int`          | Represents a signed integer.                      | `-2147483648` to `2147483647`               | `int age = 30;`            |
| `unsigned int` | Represents an unsigned integer.                   | `0` to `4294967295`                         | `unsigned int count = 5;`  |
| `bool`         | Represents a Boolean value (`true` or `false`).   | `true` or `false`                           | `bool isValid = true;`     |
| `float`        | Represents a single-precision floating-point number. | ~¬±3.4e38                                   | `float pi = 3.14f;`        |
| `double`       | Represents a double-precision floating-point number. | ~¬±1.7e308                                  | `double e = 2.71828;`      |

## Using gyb_utils.py for Shared Utilities

The `gyb_utils.py` file in the Scribble GYB configuration allows you to declare global variables, helper functions, or imports that can be reused across different GYB templates. This is especially useful when you have common logic or variables that need to be shared.

### Declaring Global Utilities in `gyb_utils.py`

You can modify the `gyb_utils.py` file to declare any utility functions, global variables, or imports. For example, you can declare shared constants or utility functions like this:

```py
# gyb_utils.py
PI = 3.14159

def square(x):
    return x * x
```

### Importing and Using Utilities in GYB Templates

Once you have your utilities declared, you can import them into any GYB template by using a simple Python import statement at the top of your template:

```py
%{
    from gyb_utils import *
}%

print("The value of PI is ${PI}")
print("The square of 4 is ${square(4)}")
```

This allows you to maintain clean, reusable code in your GYB templates, avoiding redundancy and making your templates more maintainable.

## Using GYB with Objective-C and Objective-C++

GYB can be used to generate code for Objective-C (`.m.gyb`) and Objective-C++ (`.mm.gyb`) files. This is particularly useful when generating boilerplate getter and setter methods, constants, or configuration code.

```objc
%{
   properties = ['name', 'age', 'email']
}%

@implementation User {
    % for prop in properties:
    NSString *_${prop};
    % end
}

% for prop in properties:
- (NSString *)${prop} {
    return _${prop};
}
% end

@end
```

This example generates getter methods dynamically based on the properties defined in a list.

```cpp
%{
   member_types = ['int', 'float', 'std::string']
   member_names = ['id', 'score', 'name']
}%

class Player {
    % for member_type, member_name in zip(member_types, member_names):
    ${member_type} ${member_name};
    % end

public:
    Player() {
        % for member_name in member_names:
        this->${member_name} = {};
        % end
    }
};
```

The following template demonstrates generating member variables and constructors for a C++ class.

## Running Scribble-GYB

To process your `.gyb` templates and generate source files, you must use the `generate-sources.sh` script provided in the repository.

### Steps to Generate Code

1. Ensure your GYB template files are in place with appropriate extensions (`.swift.gyb`, `.m.gyb`, `.mm.gyb`). To review the appropiate extensions for the used language look at the table below. 

   | Language | GYB Extension |
   | :------: | :------------: |
   | Swift | `.swift.gyb` |
   | ObjC | `.m.gyb` |
   | ObjC++ | `.mm.gyb` |

2. Run the `generate-sources.sh` script to generate the Swift, Objective-C, or Objective-C++ source files.

   ```sh
   chmod +x generate-sources.sh
   ./generate-sources.sh
   ```

The generated files will be saved in subdirectories under Sources or Tests, mirroring the location of the original GYB templates.

## Best Practices

- **Modular Templates:** Keep your GYB templates as modular as possible. Small, reusable templates improve maintainability.
- **Consistent Naming:** Use clear and consistent naming conventions for your GYB variables and placeholders to improve readability.
- **Leverage gyb_utils.py:** Use gyb_utils.py to declare shared utilities or constants across multiple templates, reducing redundancy.
- **Avoid Complex Logic:** Keep Python logic in GYB templates straightforward. Complex business logic should be placed in helper functions or scripts outside of the GYB templates.

## Copyright Notice

Copyright (c) 2024, ScribbleLabApp LLC. All rights reserved.

Copyright (c) 2014 - 2024, Apple Inc. -
Swift is a trademark of Apple Inc. All rights reserved.

Copyright (c) 2001-2024, Python Software Foundation -
Python is a trademark of the Python Software Foundation. All rights reserved.

## Support Us

Your support is valuable to us and helps us dedicate more time to enhancing and maintaining this repository. Here's how you can contribute:

‚≠êÔ∏è **Leave a Star:** If you find this repository useful or interesting, please consider leaving a star on GitHub. Your stars help us gain visibility and encourage others in the community to discover and benefit from this work.

‚ú® **Follow us on Social Media:** If you find this repository useful or interesting, please consider leaving a sub on YouTube or Instagram. Your sub help us gain visibility and encourage others in the community to discover and benefit from this work.

üì≤ **Share with Friends:** If you like the idea behind this project, please share it with your friends, colleagues, or anyone who might find it valuable.

# Processing GYB Sources

Generate source code using Scribble GYB

## Overview

Scribble GYB (Generate Your Boilerplate) provides developers with the capability to dynamically generate Swift, Objective-C, and Objective-C++ source code from GYB templates. These templates incorporate Python code, allowing for complex logic and variable manipulation that can yield highly customizable source files. This documentation outlines the steps necessary to process GYB templates, highlighting key considerations and the necessary configurations for successful execution.

### Prerequisites

Before you can generate source code using Scribble GYB, ensure you have the following prerequisites:

- **GYB Executable:** The gyb executable must be available in the specified directory `(./utils/gyb)` as indicated in the `generate_sources.sh` script. To install `scribble-gyb` see **<doc:Installation>**.
- **GYB Template Files:** Your GYB template files must be organized with the appropriate file extensions based on the target programming language, as outlined in the table below.
    
    | Language      | GYB Extension     |
    | :-----------: | :---------------: |
    | Swift         |   `.swift.gyb`    |
    | Objective-C   |   `.m.gyb`        |
    | Objective-C++ |   `.mm.gyb`       |

### Setting Up Your Environment

Before running the script, ensure your project directory structure is correctly set up. The `generate_sources.sh` script expects the following layout:

- Your GYB templates should be located in the `Sources` or `Tests` directories of your project.
- Ensure that you have permission to execute the script. You can modify the permissions using the following command:

    ```sh
    chmod +x generate-sources.sh
    ```

### Running the GYB Generation Script

To process your GYB templates and generate source files, execute the [`generate_sources.sh`](https://github.com/ScribleLabApp/scribble-gyb/bloob/main/generate-sources.sh) script provided in the repository. This script performs the following key operations:

1. **Navigating to the Project Directory:** The script sets the root of the project directory to the parent directory of the script's location.
2. **Defining the GYB Executable Path:** The script specifies where to find the gyb executable.
3. **Handling Line Directives:** The script allows the option to disable or enable line directives in GYB output, depending on whether you want to include file and line information for debugging purposes.
4. **Creating a Temporary Directory:** A temporary directory is created to store intermediate files during the generation process, which is cleaned up after execution.
5. **Finding GYB Template Files:** The script searches the `Sources` and `Tests` directories for files with the `.swift.gyb`, `.m.gyb`, and `.mm.gyb` extensions [`(see above)`](#prerequisites).
6. **Generating Output Files:** For each found GYB file, the script executes the GYB command to produce the corresponding source file in an `autogenerated` subdirectory.

To run the script, simply execute the following command in your terminal:

```sh
./generate-sources.sh
```

### Output Generation

After running the script, the generated files will be saved in subdirectories under the original `Sources` or `Tests` directories, preserving the original directory structure. The generated source files will have the same name as the GYB templates, but without the `.gyb` extension.

### Important Considerations

- **Adjusting the Script for Source Locations:** If your GYB templates are located in a different directory, you will need to adjust the find command within the script to point to the correct paths.

- **Keeping GYB Templates Updated:** The script automatically updates the generated files only when changes are detected in the GYB templates, preventing unnecessary overwrites and preserving your workflow.

- **Removing Obsolete Files:** The script includes functionality to clean up any autogenerated files that no longer have a corresponding GYB template, helping maintain a tidy project directory.
